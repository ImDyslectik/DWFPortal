<head>
    <title>Homepage</title>
    <link rel="stylesheet" type="text/css" href="homepage.css">
    <link rel="icon" href="" type="image/x-icon">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
</head>

<body>
<div class="top-bar">
    <ul class="navbar-primary">
        <li>
            <svg class="icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 24 24">
                <path d="M 12 2 A 1 1 0 0 0 11.289062 2.296875 L 1.203125 11.097656 A 0.5 0.5 0 0 0 1 11.5 A 0.5 0.5 0 0 0 1.5 12 L 4 12 L 4 20 C 4 20.552 4.448 21 5 21 L 9 21 C 9.552 21 10 20.552 10 20 L 10 14 L 14 14 L 14 20 C 14 20.552 14.448 21 15 21 L 19 21 C 19.552 21 20 20.552 20 20 L 20 12 L 22.5 12 A 0.5 0.5 0 0 0 23 11.5 A 0.5 0.5 0 0 0 22.796875 11.097656 L 12.716797 2.3027344 A 1 1 0 0 0 12.710938 2.296875 A 1 1 0 0 0 12 2 z"></path>
            </svg>
            <a href="/" class="navbar-items"> Home </a>
        </li>
        <li>
            <svg class="icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 24 24">
                <path d="M 12 2 A 1 1 0 0 0 11.289062 2.296875 L 1.203125 11.097656 A 0.5 0.5 0 0 0 1 11.5 A 0.5 0.5 0 0 0 1.5 12 L 4 12 L 4 20 C 4 20.552 4.448 21 5 21 L 9 21 C 9.552 21 10 20.552 10 20 L 10 14 L 14 14 L 14 20 C 14 20.552 14.448 21 15 21 L 19 21 C 19.552 21 20 20.552 20 20 L 20 12 L 22.5 12 A 0.5 0.5 0 0 0 23 11.5 A 0.5 0.5 0 0 0 22.796875 11.097656 L 12.716797 2.3027344 A 1 1 0 0 0 12.710938 2.296875 A 1 1 0 0 0 12 2 z"></path>
            </svg>
            <a href="/projecten" class="navbar-items"> Projecten </a>
        </li>
        <li>
            <svg class="icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 24 24">
                <path d="M 12 2 A 1 1 0 0 0 11.289062 2.296875 L 1.203125 11.097656 A 0.5 0.5 0 0 0 1 11.5 A 0.5 0.5 0 0 0 1.5 12 L 4 12 L 4 20 C 4 20.552 4.448 21 5 21 L 9 21 C 9.552 21 10 20.552 10 20 L 10 14 L 14 14 L 14 20 C 14 20.552 14.448 21 15 21 L 19 21 C 19.552 21 20 20.552 20 20 L 20 12 L 22.5 12 A 0.5 0.5 0 0 0 23 11.5 A 0.5 0.5 0 0 0 22.796875 11.097656 L 12.716797 2.3027344 A 1 1 0 0 0 12.710938 2.296875 A 1 1 0 0 0 12 2 z"></path>
            </svg>
            <a href="/agenda" class="navbar-items"> Agenda </a>
        </li>
        <li>
            <svg class="icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 24 24">
                <path d="M 12 2 A 1 1 0 0 0 11.289062 2.296875 L 1.203125 11.097656 A 0.5 0.5 0 0 0 1 11.5 A 0.5 0.5 0 0 0 1.5 12 L 4 12 L 4 20 C 4 20.552 4.448 21 5 21 L 9 21 C 9.552 21 10 20.552 10 20 L 10 14 L 14 14 L 14 20 C 14 20.552 14.448 21 15 21 L 19 21 C 19.552 21 20 20.552 20 20 L 20 12 L 22.5 12 A 0.5 0.5 0 0 0 23 11.5 A 0.5 0.5 0 0 0 22.796875 11.097656 L 12.716797 2.3027344 A 1 1 0 0 0 12.710938 2.296875 A 1 1 0 0 0 12 2 z"></path>
            </svg>
            <a href="/admin" class="navbar-items"> Meldingen </a>
        </li>
        <li>
            <svg class="icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 24 24">
                <path d="M 12 2 A 1 1 0 0 0 11.289062 2.296875 L 1.203125 11.097656 A 0.5 0.5 0 0 0 1 11.5 A 0.5 0.5 0 0 0 1.5 12 L 4 12 L 4 20 C 4 20.552 4.448 21 5 21 L 9 21 C 9.552 21 10 20.552 10 20 L 10 14 L 14 14 L 14 20 C 14 20.552 14.448 21 15 21 L 19 21 C 19.552 21 20 20.552 20 20 L 20 12 L 22.5 12 A 0.5 0.5 0 0 0 23 11.5 A 0.5 0.5 0 0 0 22.796875 11.097656 L 12.716797 2.3027344 A 1 1 0 0 0 12.710938 2.296875 A 1 1 0 0 0 12 2 z"></path>
            </svg>
            <a href="/" class="navbar-items"> User: <%= email %> </a>
        </li>
        <li>
            <svg class="icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 24 24">
                <path d="M 12 2 A 1 1 0 0 0 11.289062 2.296875 L 1.203125 11.097656 A 0.5 0.5 0 0 0 1 11.5 A 0.5 0.5 0 0 0 1.5 12 L 4 12 L 4 20 C 4 20.552 4.448 21 5 21 L 9 21 C 9.552 21 10 20.552 10 20 L 10 14 L 14 14 L 14 20 C 14 20.552 14.448 21 15 21 L 19 21 C 19.552 21 20 20.552 20 20 L 20 12 L 22.5 12 A 0.5 0.5 0 0 0 23 11.5 A 0.5 0.5 0 0 0 22.796875 11.097656 L 12.716797 2.3027344 A 1 1 0 0 0 12.710938 2.296875 A 1 1 0 0 0 12 2 z"></path>
            </svg>
            <a href="/admin" class="navbar-items"> Admin </a>
        </li>
    </ul>
</div>

<div class="overview">
    <div class="overview-container">
        <div class="notifications">
            <ul>
                <li>
                    <a>melding a</a>
                </li>
                <li>
                    <a>melding b</a>
                </li>
                <li>
                    <a>melding c</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="overview-container">
        <div class="assigned-projects">
            <ul>
                <li>
                    <a>project a</a>
                </li>
                <li>
                    <a>project b</a>
                </li>
                <li>
                    <a>project c</a>
                </li>
            </ul>
        </div>
    </div>
    <div class="overview-container">
        <div class="upload-text" id="message">Sleep hier je bestanden in of klik!</div>
        <div class="upload-csv"></div>
        <div id="dropArea" ondragover="handleDragOver(event)"
             ondrop="handleDrop(event)" ondragenter="handleDragEnter(event)"
             ondragleave="handleDragLeave(event)" onclick="selectFile()">
            <a class="upload-text">Upload CSV</a>
        </div>
    </div>
</div>


<a href="https://app-eu1.hubspot.com/oauth/authorize?client_id=ee514772-3efe-4518-ad4f-ae1a13610dd7&redirect_uri=http://
localhost:3000/code&scope=crm.schemas.deals.read%20crm.schemas.deals.write%20crm.schemas.contacts.read">Ga naar API (tijdelijk)</a>


<div class="project-container">
    <div class="search">
        <div class="search-field">
            <i class="magnifying-glass"></i>
            <input class="search-text">
        </div>
        <button class="search-btn"> Zoeken</button>
    </div>

    <div class="grid">
        <% const stages = { "appointmentscheduled": []
            , "qualifiedtobuy": [], "closedwon": []
            , "112184788": [], "closedlost": [] }; %>


        <% projects.forEach((project) => {
            if (stages.hasOwnProperty(project.stage)) {
                stages[project.stage].push(project);
            }
        }); %>


        <div class="projects">
            <label>Interesse</label>
            <div class="column-name">
                <% stages["appointmentscheduled"].forEach((project) => { %>
                    <div class="column-item" data-toggle="modal" data-target="#projectModal<%= project.name.replace(/\s+/g, '') %>">
                        <p><%= project.name %></p>
                    </div>

                    <!-- Modal -->
                    <div class="modal fade" id="projectModal<%= project.name.replace(/\s+/g, '') %>" tabindex="-1" role="dialog" aria-labelledby="projectModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="projectModalLabel"><%= project.name %></h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <p>Project Description: <%= project.description %></p>
                                    <p>Project Problem: <%= project.problem %></p>
                                    <p>Company: <%= project.company %></p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                <% }) %>
            </div>
        </div>

        <div class="projects">
            <label>Contact Gehad</label>
            <div class="column-name">
                <% stages["qualifiedtobuy"].forEach((project) => { %>
                    <div class="column-item" data-toggle="modal" data-target="#projectModal<%= project.name.replace(/\s+/g, '') %>">
                        <p><%= project.name %></p>
                    </div>

                    <!-- Modal -->
                    <div class="modal fade" id="projectModal<%= project.name.replace(/\s+/g, '') %>" tabindex="-1" role="dialog" aria-labelledby="projectModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="projectModalLabel"><%= project.name %></h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <p>Project Description: <%= project.description %></p>
                                    <p>Project Problem: <%= project.problem %></p>
                                    <p>Company: <%= project.company %></p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                <% }) %>
            </div>
        </div>

        <div class="projects">
            <label>Match Gemaakt</label>
            <div class="column-name">
                <% stages["closedwon"].forEach((project) => { %>
                    <div class="column-item" data-toggle="modal" data-target="#projectModal<%= project.name.replace(/\s+/g, '') %>">
                        <p><%= project.name %></p>
                    </div>

                    <!-- Modal -->
                    <div class="modal fade" id="projectModal<%= project.name.replace(/\s+/g, '') %>" tabindex="-1" role="dialog" aria-labelledby="projectModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="projectModalLabel"><%= project.name %></h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <p>Project Description: <%= project.description %></p>
                                    <p>Project Problem: <%= project.problem %></p>
                                    <p>Company: <%= project.company %></p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                <% }) %>
            </div>
        </div>

        <div class="projects">
            <label>Geen Match</label>
            <div class="column-name">
                <% stages["closedlost"].forEach((project) => { %>
                    <div class="column-item" data-toggle="modal" data-target="#projectModal<%= project.name.replace(/\s+/g, '') %>">
                        <p><%= project.name %></p>
                    </div>

                    <!-- Modal -->
                    <div class="modal fade" id="projectModal<%= project.name.replace(/\s+/g, '') %>" tabindex="-1" role="dialog" aria-labelledby="projectModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="projectModalLabel"><%= project.name %></h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <p>Project Description: <%= project.description %></p>
                                    <p>Project Problem: <%= project.problem %></p>
                                    <p>Company: <%= project.company %></p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                <% }) %>
            </div>
        </div>

        <div class="projects">
            <label>Project Afgerond</label>
            <div class="column-name">
                <% stages["112184788"].forEach((project) => { %>
                    <div class="column-item" data-toggle="modal" data-target="#projectModal<%= project.name.replace(/\s+/g, '') %>">
                        <p><%= project.name %></p>
                    </div>

                    <!-- Modal -->
                    <div class="modal fade" id="projectModal<%= project.name.replace(/\s+/g, '') %>" tabindex="-1" role="dialog" aria-labelledby="projectModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="projectModalLabel"><%= project.name %></h5>
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <p>Project Description: <%= project.description %></p>
                                    <p>Project Problem: <%= project.problem %></p>
                                    <p>Company: <%= project.company %></p>
                                    <p>Project stage: Project afgerond!</p>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                <% }) %>
            </div>
        </div>
    </div>

    <script>
        function handleDragOver(event) {
            event.preventDefault();
        }

        function handleDragEnter(event) {
            event.preventDefault();
            document.getElementById('dropArea').classList.add('invalid');
        }

        function handleDragLeave(event) {
            event.preventDefault();
            document.getElementById('dropArea').classList.remove('invalid');
        }

        function handleDrop(event) {
            event.preventDefault();
            const file = event.dataTransfer.files[0];
            handleFile(file);
            document.getElementById('dropArea').classList.remove('invalid');
        }

        function selectFile() {
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = '.csv'; // Accepteer alleen CSV-bestanden
            fileInput.addEventListener('change', (event) => {
                const file = event.target.files[0];
                handleFile(file);
            });
            fileInput.click();
        }

        function handleFile(file) {
            const formData = new FormData();
            formData.append('file', file);

            fetch('/upload', {
                method: 'POST',
                body: formData
            })
                .then(response => {
                    if (response.ok) {
                        return response.text();
                    } else {
                        throw new Error('Bestand format niet herkend.');
                    }
                })
                .then(message => {
                    console.log(message);
                    console.log('Bestandnaam:', file.name);
                    document.getElementById('message').textContent = `Bestand "${file.name}" succesvol geüpload!`;
                    document.getElementById('message').classList.remove('error');
                })
                .catch(error => {
                    console.error(error);
                    document.getElementById('message').textContent = error.message;
                    document.getElementById('message').classList.add('error');
                });
        }

        const searchParams = new URLSearchParams(window.location.search);
        console.log(searchParams);
        document.getElementById("myText").innerHTML = searchParams;
    </script>
</div>
</body>